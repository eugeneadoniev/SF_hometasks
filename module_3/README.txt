
Predict TripAdvisor Rating
В этом соревновании на Kaggle нам предстоит предсказать рейтинг ресторана в TripAdvisor.
Представьте, что вы работаете DS в компании TripAdvisor. Одна из проблем компании — это нечестные рестораны, которые накручивают себе рейтинг. Одним из способов нахождения таких ресторанов является построение модели, которая предсказывает рейтинг ресторана. Если предсказания модели сильно отличаются от фактического результата, то, возможно, ресторан играет нечестно, и его стоит проверить. Вам поставлена задача создать такую модель.

Таким образом, создадим модель, использующую алгоритмы машинного обучения. 
Алгоритм машинного обучения — RandomForestRegression. 
Наша задача состоит в том, чтобы качественно подготовить данные для обучения модели. Очистка данных и генерация новых признаков (Feature Engineering) способны значительно повысить точность модели.

Цели и задачи проекта
Целью данного проекта является подготовка данных исходного датасета для обучения модели ML, которая даст минимальную ошибку при прогнозировании рейтинга ресторана.  
Для достижения поставленной цели необходимо выполнить следующие задачи:
1. Загрузить и очистить данные, обработать пропуски.
2. Создать новые признаки, которые повысят качество моделирования.
3. Провести EDA
4. Создать модели ML c алгоритмом RandomForestRegression.
5. Обучить модель на основании подготовленного датасета
5. Получить минимально возможное отклонение прогнозных данных от фактических значений.

Описание датасета
Посмотрим на переменные, которые содержит датасет:
Датасет содержит сведения о 40 000 ресторанах Европы, а модель, которую мы будем обучать, должна будет предсказывать рейтинг ресторана по данным сайта TripAdvisor на основе имеющихся в датасете данных.
Первоначальная версия датасета состоит из десяти столбцов, содержащих следующую информацию:
Restaurant_id — идентификационный номер ресторана / сети ресторанов;
City — город, в котором находится ресторан;
Cuisine Style — кухня или кухни, к которым можно отнести блюда, предлагаемые в ресторане;
Ranking — место, которое занимает данный ресторан среди всех ресторанов своего города;
Rating — рейтинг ресторана по данным TripAdvisor (именно это значение должна будет предсказывать модель);
Price Range — диапазон цен в ресторане;
Number of Reviews — количество отзывов о ресторане;
Reviews — данные о двух отзывах, которые отображаются на сайте ресторана;
URL_TA — URL страницы ресторана на TripAdvisor;
ID_TA — идентификатор ресторана в базе данных TripAdvisor.

Выводы:
В данном проекте был проанализирован и подготовлен к моделированию датасет с информацией по ресторанам от TripAdvisor. Работа заключалась в очистке данных, заполнении пропусков и создании новых признаков с целью уменьшить ошибку прогноза рейтинга ресторана. Категориальные признаки, по возможности, были переведены в числовой формат для использования в модели ML.
В датасете были обнаружены пропуски данных в признаках 'Number of Reviews', 'Price Range' и 'Cuisine Style'. Пропуски были заполнены, при этом были созданы новые признаки 'isNAN' с информацией об отсутствии данных.
Категориальный признак 'City' включает в себя 31 город. Больше всего ресторанов (7193) - в Лондоне. Признак был закодирован при помощи функции get_dummies.
Ордерный признак 'Price Range'- 3 градации - заменили последовательными числами 1,2,3. Больше всего ресторанов - в среднем ценовом диапазоне.
Категориальный признак 'Cuisine Style': в датасете 125 уникальных кухонь. Самые распространенные - вегетарианская и европейская. На его основе создан новый признак с количеством кухонь в ресторане.
Из признака 'Reviews' были извлечены даты отзывов. Создан признак с разницей в днях между двумя отзывами, а также признак "старость ревью относительно самого свежего в днях".
Создан новый признак 'Relative_Ranking'- отношение ранга ресторана к количеству ресторанов в этом городе по данным датасета. Важно: в итоге этот признак внес наибольший вклад в повышение точности моделирования.
Для создания нового признака 'Population' была найдена в интернете информация о населении городов датасета и введена вручную в виде словаря. На основании этого созданы новые относительные признаки: 'Review to Population' (отношение количества отзывов к населению) и 'Rel_Rank to Population' (отношение относительного ранга к населению).
Матрица корреляций показала отсутствие мультиколлинеарности, поэтому все признаки были оставлены для дальнейшего использования в модели ML.
Было произведено моделирование с использованием алгоритма машинного обучения "RandomForestRegression". Округление результатов моделирования (до 0.5, как шаг 'Rating' в исходном датасете) уменьшило абсолютную ошибку. Метрика Mean Absolute Error показала отклонение MAE=0.16875 от фактических значений. Это меньше, чем MAE из baseline notebook.
Таким образом, описанная выше обработка и feature engineering дали свой эффект и повысили точность моделирования.
